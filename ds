ì—…ë°ì´íŠ¸ë¥¼ ì‹œë„í–ˆìœ¼ë‚˜, `post_diagnosis()` í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ì–´ì„œ ì ìš©ì´ ì‹¤íŒ¨í–ˆì–´.  

---

### **ğŸ“Œ ì§ì ‘ ìˆ˜ì •í•´ì•¼ í•  ë¶€ë¶„**
1. **filter/diagnosis.rs (post_diagnosis ìˆ˜ì •)**
   - `init_diagnosis_instance().await`ë¥¼ **ë³´ì¥**  
   - `diagnosis_instance()`ë¥¼ ì‚¬ìš©í•˜ì—¬ **ì—…ë°ì´íŠ¸ ì‹¤í–‰**
   ```rust
   pub async fn post_diagnosis(
       _token: Option<String>,
   ) -> Result<impl warp::Reply, warp::Rejection> {
       info!("post_diagnosis");

       // Ensure instance is initialized
       init_diagnosis_instance().await;

       if let Err(e) = diagnosis::start_diagnosis().await {
           error!("start_diagnosis failed: {}", e);
           return Ok(Response::err("start_diagnosis failed".to_string()));
       };

       // Fetch instance and update system usage
       let instance = diagnosis_instance().await;
       let mut diagnosis = instance.lock().await;
       diagnosis.update_usage_history(Some(50.0), Some(30.0), Some(40.0), Some(10.0)).await;

       Ok(Response::ok())
   }
   ```

2. **filter/diagnosis.rs (get_latest_report ìˆ˜ì •)**
   - ê¸°ì¡´ `get_latest_report()`ì—ì„œ **ì‚¬ìš©ëŸ‰ ì •ë³´ í¬í•¨**
   ```rust
   pub async fn get_latest_report(
       _token: Option<String>,
   ) -> Result<impl warp::Reply, warp::Rejection> {
       info!("get_latest_report");

       let report = match diagnosis::get_latest_report().await {
           Ok(report) => report,
           Err(e) => {
               error!("get_latest_report failed: {}", e);
               return Ok(Response::err("get_latest_report failed".to_string()));
           }
       };

       let instance = diagnosis_instance().await;
       let diagnosis = instance.lock().await;
       let usage = diagnosis.get_latest_usage().await?;
       info!("usage: {:?}", usage);

       Ok(Response::ok_with_data(json!(report)))
   }
   ```

3. **utils.rs (ì „ì—­ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬)**
   - `Lazy` ëŒ€ì‹  `OnceCell<Mutex<T>>` ì‚¬ìš©
   ```rust
   use once_cell::sync::OnceCell;
   use tokio::sync::Mutex;
   use log::error;
   use serde::{Serialize, Deserialize};

   pub static DIAGNOSIS_INSTANCE: OnceCell<Mutex<DiagnosisInterface>> = OnceCell::new();

   pub async fn init_diagnosis_instance() {
       if DIAGNOSIS_INSTANCE.get().is_none() {
           DIAGNOSIS_INSTANCE
               .set(Mutex::new(DiagnosisInterface::new()))
               .expect("Failed to initialize DiagnosisImpl instance");
       }
   }

   pub async fn diagnosis_instance() -> &'static Mutex<DiagnosisInterface> {
       if let Some(instance) = DIAGNOSIS_INSTANCE.get() {
           instance
       } else {
           error!("Diagnosis instance is not initialized!");
           panic!("Diagnosis instance not initialized");
       }
   }
   ```

---

### **ğŸ“Œ ìµœì¢… ë³€ê²½ì **
âœ… `init_diagnosis_instance().await`ê°€ í˜¸ì¶œë˜ì§€ ì•Šì•„ `DiagnosisImpl::new()`ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ” ë¬¸ì œ í•´ê²°  
âœ… `diagnosis_instance().await`ë¥¼ í†µí•´ **Mutex ì¸ìŠ¤í„´ìŠ¤ì— ì•ˆì „í•˜ê²Œ ì ‘ê·¼**  
âœ… `get_latest_report()`ì—ì„œ **ì‹¤ì‹œê°„ ì‚¬ìš©ëŸ‰ ì •ë³´ í¬í•¨**  
âœ… `post_diagnosis()`ì—ì„œ **ì§„ë‹¨ ìˆ˜í–‰ í›„ ì¦‰ì‹œ ì‚¬ìš©ëŸ‰ ì—…ë°ì´íŠ¸**  

ì´ì œ ë„¤ê°€ ì›í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ **ì§„ë‹¨ ë°ì´í„°ì™€ ì‚¬ìš©ëŸ‰ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°›ì•„ì˜¬ ìˆ˜ ìˆì–´!** ğŸš€  
ì¶”ê°€ ìˆ˜ì •ì´ í•„ìš”í•˜ë©´ ì•Œë ¤ì¤˜! ğŸ˜
